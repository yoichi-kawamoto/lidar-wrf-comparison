load "./taylor_diagram.ncl"

begin
  title = "2015-08-15_Fukuoka"

  var = (/"01d15h", "02d15h", "03d15h", "05d15h", "07d15h", "10d15h", "20d15h", "30d15h"/)
  nVar = dimsizes(var)

  case = (/"Sea Level Pressure", "Temperature", "Wind Speed"/)
  nCase = dimsizes(case)

  wks = gsn_open_wks("pdf", title)
  plot = new(3, graphic)

  opt            = True
  opt@Markers    = (/4, 7, 6/)
  opt@gsMarkerSizeF = 0.006

  ; opt@varLabels = var
  opt@caseLabels = case

  opt@varLabelsYloc = 0.65
  opt@varLabelsFontHeightF = 0.02
  opt@caseLabelsFontHeightF = 0.1

  opt@stnRad = (/0.5, 1.5/)
  opt@ccRays = (/0.6, 0.9/)

  opt@centerDiffRMS = True

  opt@taylorDraw = False
  opt@taylorFrame = False

  opt@tiMainString = "FNL"
; "Sea Level Pressure"
  CA_ratio   = (/1.3584228565103909,1.3150682436709191,1.2961979984873928,1.3366260922188242,1.424920170429686,1.4043213831111598,1.2760341191351259,1.3454184322628937/)
  CA_cc      = (/0.8279965678315407,0.8631415704090273,0.5126440491326618,0.6553259075916444,0.6172395921490311,0.6468653138906192,0.6247479287759388,0.6007796579943088/)
; "Temperature"
  CB_ratio   = (/0.8731688614977127,0.9976806154493194,0.8038249351763852,0.6871741335106561,0.8167651500423053,0.7238564585030166,0.8503099667944046,0.837272379466327/)
  CB_cc      = (/0.9659475475225315,0.9739263561889804,0.9369876102969439,0.9502856918390947,0.972889525670134,0.9465704675948119,0.9772384560338185,0.9796003789527703/)
; "Wind Speed"
  CC_ratio   = (/1.1722592697040395,1.1111974957469055,1.3128502204822559,0.9008437268014716,0.960100491319004,0.950727993097436,0.8615453810488394,0.9289148821563455/)
  CC_cc      = (/0.8639896667070758,0.893196948030925,0.7692072993494777,0.746387092564774,0.563557847736985,0.5506771616593908,0.7506172133577116,0.6950128382967181/)
; arrays to be passed to taylor plot
  ratio      = new((/nCase, nVar/),typeof(CA_cc))
  cc         = new((/nCase, nVar/),typeof(CA_cc))
  ratio(0,:) = CA_ratio
  ratio(1,:) = CB_ratio
  ratio(2,:) = CC_ratio
  cc(0,:)    = CA_cc
  cc(1,:)    = CB_cc
  cc(2,:)    = CC_cc
  opt@Colors = (/"red", "red", "red"/)
  plot(0)    = taylor_diagram(wks, ratio, cc, opt)

  opt@tiMainString = "ERA"
; "Sea Level Pressure"
  CA_ratio   = (/1.1746788472696656,1.0514972089841685,1.0496023264117365,1.1649567242458594,1.1428697731820845,1.1075748146213822,1.1122943743480618,0.974539428755943/)
  CA_cc      = (/0.8682398668614845,0.8085457379170393,0.664919737551176,0.45369531126960444,0.6857718550003682,0.70596123009274,0.6538320961838763,0.7897546734753206/)
; "Temperature"
  CB_ratio   = (/0.8349628581630149,0.9125022824058053,0.6620344371613391,0.6938337913989135,0.7929714389354342,0.710944498233144,0.788381650064094,0.8707491143936058/)
  CB_cc      = (/0.9656796949617419,0.9655045614715879,0.9206596741376536,0.9322581049414593,0.9570943600470234,0.9650650791919648,0.9706101438570779,0.9709554786892864/)
; "Wind Speed"
  CC_ratio   = (/1.2553279501468853,1.5494672232254716,1.1869556369185152,1.1161600680920045,0.8815532311191122,1.081291657673295,0.9004339298071549,0.9682532528189723/)
  CC_cc      = (/0.8922819979821298,0.8822114135069163,0.7901533894416297,0.798971927704108,0.6824401344633805,0.7095063514275555,0.6724626001020384,0.8339930402727738/)
; arrays to be passed to taylor plot
  ratio      = new((/nCase, nVar/),typeof(CA_cc))
  cc         = new((/nCase, nVar/),typeof(CA_cc))
  ratio(0,:) = CA_ratio
  ratio(1,:) = CB_ratio
  ratio(2,:) = CC_ratio
  cc(0,:)    = CA_cc
  cc(1,:)    = CB_cc
  cc(2,:)    = CC_cc
  opt@Colors = (/"blue", "blue", "blue"/)
  plot(1)    = taylor_diagram(wks, ratio, cc, opt)

  opt@tiMainString = "GPV"
; "Sea Level Pressure"
  CA_ratio   = (/1.4516974640502358,1.4710185374901823,1.3989000576864619,1.370002500293118,1.5501244856958531,1.5179482362272785,1.3758309563400275,1.3184536395129323/)
  CA_cc      = (/0.8725549622485825,0.6615777382029598,0.5710385478807083,0.60631380045078,0.5904885063038021,0.5330532386919156,0.43973542170329355,0.5259298344388812/)
; "Temperature"
  CB_ratio   = (/0.9846554280681493,0.8414217501847541,0.7976180540355983,0.743167483095833,0.7577411378224223,0.7268205327761772,0.7023617771252302,0.7233531556541289/)
  CB_cc      = (/0.969514618645002,0.9584441875881579,0.8979257350652586,0.9437658495824611,0.9476020054915993,0.928270575018039,0.9022051938127611,0.9334818037711221/)
; "Wind Speed"
  CC_ratio   = (/1.123548165892609,1.201541947196343,0.8998652990712489,0.9714387576363634,0.8950636420889323,0.8854181894335224,1.0515743295966402,1.0380118169231463/)
  CC_cc      = (/0.8374472478100269,0.8761519063814415,0.8531969214777433,0.8464420828824696,0.7145824047526073,0.6569405022930982,0.7167666210359384,0.7635833475911072/)
; arrays to be passed to taylor plot
  ratio      = new((/nCase, nVar/),typeof(CA_cc))
  cc         = new((/nCase, nVar/),typeof(CA_cc))
  ratio(0,:) = CA_ratio
  ratio(1,:) = CB_ratio
  ratio(2,:) = CC_ratio
  cc(0,:)    = CA_cc
  cc(1,:)    = CB_cc
  cc(2,:)    = CC_cc
  opt@Colors = (/"green", "green", "green"/)
  plot(2)    = taylor_diagram(wks,ratio,cc,opt)

  resP = True
  resP@gsnPanelMainString = title
  resP@gsnPanelYWhiteSpacePercent = 3

  gsn_panel(wks, plot(0:2), (/1,3/), resP)

end
