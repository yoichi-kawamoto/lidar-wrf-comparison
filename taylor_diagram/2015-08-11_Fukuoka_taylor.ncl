load "./taylor_diagram.ncl"

begin
  title = "2015-08-11_Fukuoka"

  var = (/"01d15h", "02d15h", "03d15h", "05d15h", "07d15h", "10d15h", "20d15h", "30d15h"/)
  nVar = dimsizes(var)

  case = (/"Sea Level Pressure", "Temperature", "Wind Speed"/)
  nCase = dimsizes(case)

  wks = gsn_open_wks("pdf", title)
  plot = new(3, graphic)

  opt            = True
  opt@Markers    = (/4, 7, 6/)
  opt@gsMarkerSizeF = 0.006

  ; opt@varLabels = var
  opt@caseLabels = case

  opt@varLabelsYloc = 0.65
  opt@varLabelsFontHeightF = 0.02
  opt@caseLabelsFontHeightF = 0.1

  opt@stnRad = (/0.5, 1.5/)
  opt@ccRays = (/0.6, 0.9/)

  opt@centerDiffRMS = True

  opt@taylorDraw = False
  opt@taylorFrame = False

  opt@tiMainString = "FNL"
; "Sea Level Pressure"
  CA_ratio   = (/0.633500557089589,0.6793868841488719,0.6304705238425874,0.6305186266158884,0.7155253459279234,0.7960185503025424,0.7474937817224523,0.7442184241535283/)
  CA_cc      = (/0.5819467027553681,0.6149062563224664,0.3001405755171294,0.3531637715508363,0.5064711057957442,0.8500189040873444,0.7254108445247948,0.734866877619358/)
; "Temperature"
  CB_ratio   = (/1.1783828517050854,1.1590040623998035,1.1872589583813853,1.0258397738788603,1.0016769766168079,0.7785446654791361,0.8907968797312495,0.9984123664741715/)
  CB_cc      = (/0.9438593260060076,0.9487584057584898,0.9443128503874186,0.9461758240802661,0.9392650740015701,0.9048413272913107,0.9295337460188291,0.9399659994390367/)
; "Wind Speed"
  CC_ratio   = (/1.2590093625025005,1.4833891492081934,1.6354325401939331,1.510454196374473,1.506785894382971,1.265179115581109,1.4401034492318967,1.5343779819309864/)
  CC_cc      = (/0.8984064098423336,0.9264658952889874,0.9191715305696581,0.8993786203145391,0.8629838437882833,0.7959348361086108,0.836428611912332,0.8370127180771041/)
; arrays to be passed to taylor plot
  ratio      = new((/nCase, nVar/),typeof(CA_cc))
  cc         = new((/nCase, nVar/),typeof(CA_cc))
  ratio(0,:) = CA_ratio
  ratio(1,:) = CB_ratio
  ratio(2,:) = CC_ratio
  cc(0,:)    = CA_cc
  cc(1,:)    = CB_cc
  cc(2,:)    = CC_cc
  opt@Colors = (/"red", "red", "red"/)
  plot(0)    = taylor_diagram(wks, ratio, cc, opt)

  opt@tiMainString = "ERA"
; "Sea Level Pressure"
  CA_ratio   = (/1.0102913833877871,1.1914041850241786,1.0577040635243065,1.045135708565026,1.2053294748405217,1.263754465373858,1.1692234737158265,1.293173448751033/)
  CA_cc      = (/0.9321217448958775,0.9184416256047674,0.8605100886684138,0.8699361393986379,0.8398281756859522,0.8804996596537726,0.9016483885912515,0.9042738240604786/)
; "Temperature"
  CB_ratio   = (/1.0453728914290332,1.0647936106215665,1.0772492708168537,1.1157850894969508,1.1090390803785577,0.9485965160447768,0.856017203067371,0.9642702729506097/)
  CB_cc      = (/0.9083498349917526,0.9226899130198695,0.8400136006641744,0.9167961837575239,0.8950625345099527,0.905218513132683,0.8931680033351781,0.8673247163407013/)
; "Wind Speed"
  CC_ratio   = (/1.4796892892684257,1.5717465526139858,1.388423562389802,1.4773385373755799,1.554700314456034,1.6734351889799493,1.498692492726725,1.5120399586733477/)
  CC_cc      = (/0.9189277016154539,0.8929456105170331,0.6555334683181903,0.8393945097720282,0.7723279883343872,0.8415965639364816,0.8129765581968118,0.841210779118272/)
; arrays to be passed to taylor plot
  ratio      = new((/nCase, nVar/),typeof(CA_cc))
  cc         = new((/nCase, nVar/),typeof(CA_cc))
  ratio(0,:) = CA_ratio
  ratio(1,:) = CB_ratio
  ratio(2,:) = CC_ratio
  cc(0,:)    = CA_cc
  cc(1,:)    = CB_cc
  cc(2,:)    = CC_cc
  opt@Colors = (/"blue", "blue", "blue"/)
  plot(1)    = taylor_diagram(wks, ratio, cc, opt)

  opt@tiMainString = "GPV"
; "Sea Level Pressure"
  CA_ratio   = (/1.0192735218028424,1.0294664166470424,1.1045965775567328,1.0212494650255923,0.974791864728412,0.919819311432695,0.8724129448438758,1.0150521187436645/)
  CA_cc      = (/0.8153534357882336,0.8895553558374557,0.8304154713814723,0.8424147723561807,0.852569813232699,0.776176193851313,0.7899113641177855,0.8009900120189792/)
; "Temperature"
  CB_ratio   = (/1.0425227525088465,1.1136862932179346,1.103580147155595,1.005461795771338,0.9282608253531272,0.6945940158711498,0.7505175815909794,0.8185963074909466/)
  CB_cc      = (/0.9355687603261643,0.9207275732194524,0.9268878518047957,0.9188380178767322,0.9361141348944767,0.7611807478227974,0.8331535936769894,0.9156477329744943/)
; "Wind Speed"
  CC_ratio   = (/1.365773608566614,1.5021731308192732,1.8347533740979867,1.5989098396854167,1.5806810128407673,1.208778280050405,1.1529597995113727,1.468970129699228/)
  CC_cc      = (/0.8911490198401988,0.8932009508856112,0.9105804112533082,0.8812845692313667,0.8681088300573729,0.5842077261161012,0.6343566157944239,0.8893618098062946/)
; arrays to be passed to taylor plot
  ratio      = new((/nCase, nVar/),typeof(CA_cc))
  cc         = new((/nCase, nVar/),typeof(CA_cc))
  ratio(0,:) = CA_ratio
  ratio(1,:) = CB_ratio
  ratio(2,:) = CC_ratio
  cc(0,:)    = CA_cc
  cc(1,:)    = CB_cc
  cc(2,:)    = CC_cc
  opt@Colors = (/"green", "green", "green"/)
  plot(2)    = taylor_diagram(wks,ratio,cc,opt)

  resP = True
  resP@gsnPanelMainString = title
  resP@gsnPanelYWhiteSpacePercent = 3

  gsn_panel(wks, plot(0:2), (/1,3/), resP)

end
