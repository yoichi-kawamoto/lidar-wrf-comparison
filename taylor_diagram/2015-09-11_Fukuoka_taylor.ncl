load "./taylor_diagram.ncl"

begin
  title = "2015-09-11_Fukuoka"

  var = (/"01d15h", "02d15h", "03d15h", "05d15h", "07d15h", "10d15h", "20d15h", "30d15h", "60d15h"/)
  nVar = dimsizes(var)

  case = (/"Sea Level Pressure", "Temperature", "Wind Speed"/)
  nCase = dimsizes(case)

  wks = gsn_open_wks("pdf", title)
  plot = new(3, graphic)

  opt            = True
  opt@Markers    = (/4, 7, 6/)
  opt@gsMarkerSizeF = 0.006

  ; opt@varLabels = var
  opt@caseLabels = case

  opt@varLabelsYloc = 0.65
  opt@varLabelsFontHeightF = 0.02
  opt@caseLabelsFontHeightF = 0.1

  opt@stnRad = (/0.5, 1.5/)
  opt@ccRays = (/0.6, 0.9/)

  opt@centerDiffRMS = True

  opt@taylorDraw = False
  opt@taylorFrame = False

  opt@tiMainString = "FNL"
; "Sea Level Pressure"
  CA_ratio   = (/0.6558590210369137,0.47001398106881515,0.3982584509892762,0.5765494630495924,0.4436651830691291,0.4315030196439023,0.4534699570304551,0.45401048721662,0.4906417210027433/)
  CA_cc      = (/0.9024519419279934,0.6287710676672202,0.12733167765646589,-0.1472704091609783,0.2591037892842708,0.12007025802623061,0.0537699531509065,0.10255190629815635,0.14454694072037147/)
; "Temperature"
  CB_ratio   = (/0.8888580450858669,0.9154865151967307,0.755304040042856,0.37942780923990005,0.38225099994115336,0.32926107094006746,0.3826450618047138,0.40359457515941627,0.39557414351326275/)
  CB_cc      = (/0.9813640512740773,0.9862720729455766,0.9696431187148096,0.8670083504624959,0.7732644745584454,0.6806042705196109,0.8370039099046804,0.8392711819526038,0.8555821865192995/)
; "Wind Speed"
  CC_ratio   = (/1.0282374522118294,0.970922805937465,0.8792276327563056,1.8655812220031671,0.9274263745482293,1.252530905483556,1.1554116772334224,1.1731625001802146,1.0777435527272858/)
  CC_cc      = (/0.9316419264621321,0.8415967335735399,0.8762700804925485,0.3111385237428051,0.23334759121037185,0.06379016504319603,0.5116690049265407,0.34665757449207996,0.25151591390749384/)
; arrays to be passed to taylor plot
  ratio      = new((/nCase, nVar/),typeof(CA_cc))
  cc         = new((/nCase, nVar/),typeof(CA_cc))
  ratio(0,:) = CA_ratio
  ratio(1,:) = CB_ratio
  ratio(2,:) = CC_ratio
  cc(0,:)    = CA_cc
  cc(1,:)    = CB_cc
  cc(2,:)    = CC_cc
  opt@Colors = (/"red", "red", "red"/)
  plot(0)    = taylor_diagram(wks, ratio, cc, opt)

  opt@tiMainString = "ERA"
; "Sea Level Pressure"
  CA_ratio   = (/0.6392005836711574,0.5159605453850004,0.5556450572613627,0.4807349871412352,0.3013111444026511,0.428447253908778,0.3303608275785798,0.32256603722379695,0.37804070045657223/)
  CA_cc      = (/0.9424628632801829,0.24414769108929144,-0.40915949758477044,-0.44670653563849955,0.0580490262872621,0.42767190582592357,0.29509287407492196,0.3335354160905428,0.3336286536927711/)
; "Temperature"
  CB_ratio   = (/0.8374612961307527,0.8147616486504131,0.42713291964282435,0.42801302781636397,0.4380965289187858,0.5142837780527658,0.45245577249320545,0.43226227114664056,0.4711699560041485/)
  CB_cc      = (/0.9824461064730965,0.9794720876569148,0.9351538009403562,0.8123791407117675,0.9144076406532244,0.9456759777634128,0.9320273663836903,0.9263138752364235,0.9175678302211997/)
; "Wind Speed"
  CC_ratio   = (/1.0281852268932081,0.8589870472466576,0.9608335203237447,1.9238574341882817,1.3913023915965017,1.2217409296199901,1.254065982419196,1.2310374653162626,1.2617032559754682/)
  CC_cc      = (/0.9372087221160957,0.8791376430162168,0.5919310647749652,0.17303741862339644,0.34243594497943325,0.4685983504535307,0.3901458231826062,0.4009863950495079,0.5023640467208327/)
; arrays to be passed to taylor plot
  ratio      = new((/nCase, nVar/),typeof(CA_cc))
  cc         = new((/nCase, nVar/),typeof(CA_cc))
  ratio(0,:) = CA_ratio
  ratio(1,:) = CB_ratio
  ratio(2,:) = CC_ratio
  cc(0,:)    = CA_cc
  cc(1,:)    = CB_cc
  cc(2,:)    = CC_cc
  opt@Colors = (/"blue", "blue", "blue"/)
  plot(1)    = taylor_diagram(wks, ratio, cc, opt)

  opt@tiMainString = "GPV"
; "Sea Level Pressure"
  CA_ratio   = (/0.7112353279415828,0.5360262816244914,0.6133184071104973,0.8402915591365906,0.6689605038295886,0.7094658640726123,0.5651329033252265,0.6801930861389162,0.7015365534727959/)
  CA_cc      = (/0.9183038403898927,0.20876382039738928,0.0888598952361741,-0.5280878976870963,-0.3026612250545276,-0.3885203597872041,-0.01198132596894273,-0.354212360102993,-0.45293887867252275/)
; "Temperature"
  CB_ratio   = (/0.9444696334065401,0.7338277322244524,0.48424080932661806,0.35962506051440163,0.41932462718872227,0.36448302661405046,0.4640668877083801,0.3678476940045777,0.33933893251521724/)
  CB_cc      = (/0.9851788820800043,0.9407859557295234,0.7433546008911834,0.7693541961680669,0.7977734725772286,0.723817343843872,0.7347041024682516,0.8266697813150476,0.8251671585353445/)
; "Wind Speed"
  CC_ratio   = (/1.2129613631722187,0.8862573982586672,0.9051200919903107,1.686714933466585,1.134920950127928,1.3673771442198683,1.067260829835038,0.9305278614217118,1.0388337176953923/)
  CC_cc      = (/0.8771927954763515,0.728966524335671,0.19947752283348538,-0.1078951781397998,0.016562472739227358,0.07236953386178284,0.1384730023030058,-0.014629181323918489,0.10369936458778503/)
; arrays to be passed to taylor plot
  ratio      = new((/nCase, nVar/),typeof(CA_cc))
  cc         = new((/nCase, nVar/),typeof(CA_cc))
  ratio(0,:) = CA_ratio
  ratio(1,:) = CB_ratio
  ratio(2,:) = CC_ratio
  cc(0,:)    = CA_cc
  cc(1,:)    = CB_cc
  cc(2,:)    = CC_cc
  opt@Colors = (/"green", "green", "green"/)
  plot(2)    = taylor_diagram(wks,ratio,cc,opt)

  resP = True
  resP@gsnPanelMainString = title
  resP@gsnPanelYWhiteSpacePercent = 3

  gsn_panel(wks, plot(0:2), (/1,3/), resP)

end
